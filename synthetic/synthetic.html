<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
            "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
        <title>Synthetic Typing Test</title>
        <style type='text/css'>
            body {font-family: verdana}
			td {text-align: right}
            td:nth-child(even) {background: #CCd}
			#key th:nth-child(even) {background: #CCf}
			#who th:nth-child(even) {background: #fCb}
        </style>
    </head>
    <body>
    	<p>Type: <code>1 a [ENTER] [BACKSPACE] [DOWN]</code> with no spaces</p>
		<input id='manual'/>
		
		
		<p>Synthetic Driven</p>
		<input id='synthetic'/>
		
		<table>
			<tr id='key'>
				<td></td>
				<th colspan='4'>1</th>
				<th colspan='4'>a</th>
				<th colspan='4'>[ENTER]</th>
				<th colspan='4'>[BACKSPACE]</th>
				<th colspan='4'>[DOWN]</th>
			</tr>
			<tr id='who'>
				<th></th>
				<th colspan='2'>char</th>
				<th colspan='2'>key</th>
				<th colspan='2'>char</th>
				<th colspan='2'>key</th>
				<th colspan='2'>char</th>
				<th colspan='2'>key</th>
				<th colspan='2'>char</th>
				<th colspan='2'>key</th>
				<th colspan='2'>char</th>
				<th colspan='2'>key</th>
			</tr>
			<tr id='types'>
				<td></td>
			</td>
			<tr id='keydown'><td>keydown</td></tr>
			<tr id='keypress'><td>keypress</td></tr>
			<tr id='keyup'><td>keyup</td></tr>
		</table>
		
		<h2>
			Other things
		</h2>
		<input id='link'/>
		<a href='javascript://' id='run'>run</a>
		
		
		<form id='outer'>
			<select name='select' id='select'>
				<option value='1' id='one'>one</option>
				<option value='2' id='two'>two</option>
			</select>
		</form>
		<br/>
		<br/>
		<div id='counter' tabindex='0'></div>
		<div id='outer'></div>
<script type='text/javascript' src='../../steal/steal.js'></script>
<script type='text/javascript'>
	steal.plugins('funcunit/synthetic').start();
</script>
<script type='text/javascript' id="demo-source">
	var gId = function(id){
		return document.getElementById(id)
	},
	bind = function(el, ev, func){
		Synthetic.bind(gId(el), ev,func);
	},
	counters = {
		manual : {},
		synthetic : {}
	},
	events = ['keydown','keypress','keyup'];
	
	gId('manual').value = "";
	
	var create = function(type, event){
		
		bind(type, event,function(ev){
			//fill in
			var where = (4*counters[type][event]) + (type != "synthetic" ? 0 : 1) + 1
			var row = gId(ev.type)
			if(row.childNodes[where]){
				row.childNodes[where].innerHTML = ""+(ev.charCode === undefined ? "u" :ev.charCode ) +"";
				row.childNodes[where+2].innerHTML = ""+ev.keyCode+"";
				
			}
			console.log(event, " char ", ev.charCode, " key ", ev.keyCode)

			counters[type][event]++;
		}, false);
		gId(type).value = ""
	}
	var types = gId('types')
	for(var t=0; t< 20; t++){
		var td = document.createElement('td')
		td.innerHTML = t%2 == 1 ? "syn" : "man"
		types.appendChild(td)
	}
	
	for(var i =0; i < events.length; i++){
		var row = gId(events[i])
		for(var c=0; c < 20; c++){
			var td = document.createElement('td');
			if(c%2 == 0 ){
				td.style.borderLeft = "solid 1px black"
			}
			row.appendChild(td)
		}
			
		
		counters.manual[events[i]] = 0
		counters.synthetic[events[i]] = 0;
		
		create("manual",events[i]);
		create("synthetic",events[i])
		
	}
	
	window.onload = function(){
		
		
		setTimeout(function(){
			new Synthetic("key","1").send( gId('synthetic')  );
			new Synthetic("key","a").send( gId('synthetic')  );
			new Synthetic("key","\n").send( gId('synthetic')  );
			new Synthetic("key","\b").send( gId('synthetic')  );
		},1)
		
		
		Synthetic.bind(gId('link'),"click",function(ev){
			console.log('click')
		})
		Synthetic.bind(gId('link'),"focus",function(ev){
			ev.preventDefault();
			console.log('focus')
		})
		Synthetic.bind(gId('link'),"mousedown",function(ev){
			console.log('mousedown')
		})
		Synthetic.bind(gId('link'),"mouseup",function(ev){
			console.log('mouseup')
			ev.preventDefault();
		})
		
		
		
		Synthetic.bind(gId('run'),"click",function(){
			setTimeout(function(){
				new Synthetic("clicker").send( gId('link') )
				
				//console.log(document.defaultView.getComputedStyle(gId('link'),null))
			},500)
			
		})
		var pd = function(ev){
			if(ev.preventDefault)
				ev.preventDefault();

			ev.returnValue = false;
		}
		
		bind('select','mousedown',function(ev){
			pd(ev)
			console.log('md')
		})
		bind('select','focus',function(ev){
			pd(ev)
			console.log('focus')
		})
		bind('select','click',function(ev){
			console.log('click')
			pd(ev)
		})
		go = function(){
			Synthetic.createEvent('mousedown',{}, gId('one') )
			
			//
			
		}
		var count = 0
		setInterval(function(){
			gId('counter').innerHTML = (count++)
		},1000)
	}
	if(!window.console){
		console = {
			log : function(txt){
				gId('outer').innerHTML = gId('outer').innerHTML +"<p>"+txt+"</p>"
			}
		}
	}
	
</script>
    </body>
</html>